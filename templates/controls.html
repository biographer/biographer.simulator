{{extend 'content.html'}}

<style>
	#Controls		{
				border:			1px solid black;
				position:		absolute;
				top:			-10%;
				right:			1%;
				z-index:		+5;
				background-color:	white;
				opacity:		1;
				}

	.network		{
				border:			none;
				width:			100%;
				height:			94%;
				overflow:		scroll;
				}
</style>

<script src="../static/BooleanNet/Simulator.js"></script>
<script>
	// settings
	green = '#10d010';
	red = '#d01010';
	yellow = '#f4fd01';
	black = '#000000';
	blue = '#7474cf';
	active = green;
	inactive = '#ffffff';
	cyclic_attraktor = '#f9f883';

	// input, provided by the server
	BooleanNetwork = '{{try:}}{{ = XML(session.bioGraph.BooleanNetwork.replace('\n', '\\n\'\n+\'')) }}{{except:}}{{pass}}';
	Nodes = [ {{=XML(Nodes)}} ];
	update_rules = { {{=XML(updateRules)}} };

	// initialize, prepare for simulation
	initialize();

{{ = XML(ScenarioFunctions) }}
</script>

<div id=Controls>
	<table>
		<tr>
		<td>
			Import network:
			<br/>
			<select size=3 style="width:220px;">
			</select>
			<br/>
			<input type=button value="Load"/>
			<input type=file value="" onchange="Import(event);"/>

			<br/>

			<input type=button onClick='ViewPython();' value="View Python source"/>
			<input type=button onClick='EditNetwork();' value="Edit network" />
			<br/>
			<input type=button onClick='Preferences();' value="Edit simulation preferences" />
			<br/>

			&nbsp;Delay between iterations: <input id=Delay type=text value='200' style='width:50px; text-align:right;' /> ms
			<br/>
			<input type=button value="Simulate" onClick="Iterate();" />
			<input type=button value="Find attractors" onClick="FindAttractors();" />
		</td>
		<td>
			Current network state:<br/>
			Load: <input type=file value="Load" onchange="LoadState(event);"/>
			<br/>
			<input type=button value="Save" onclick="SaveState();"/>
			<input type=button value="Compare" onclick="CompareState();" />
			<br/>
			<select size=3 style="width:220px;">
			</select>
			<br/>
			<input type=button value="Apply" onclick="ApplyState();" />
			<input type=button value="Reset" onclick="ResetState();" />
			
		</td>
	</tr>
	<tr>
		<td colspan=2>
			&nbsp;<label id='Progress' style='color:green; font-weight:bold;'></label>
			<label id='Steps' style='color:blue; font-weight:bold; float:right;'>0</label>
		</td>
	</tr>
	</table>
</div>

<style>
	#biographertab	{
			display:	none;
			}
</style>

<script>
	function showGraphviz() {
		document.getElementById("graphviztab").style.display = "inline";
		document.getElementById("biographertab").style.display = "none";
		}

	function showbiographer() {
		document.getElementById("graphviztab").style.display = "none";
		document.getElementById("biographertab").style.display = "inline";
		}
</script>

<input type=button value="Graphviz Tree" onclick="showGraphviz();"/>
<input type=button value="biographer UI" onclick="showbiographer();"/>

<div id=graphviztab>
	<!--img name=preview id=preview src="{{ = session.graphviz_image }}" style="width:100px; height:100px;"/-->
	<object type="image/svg+xml" class=network id=network data="{{ = session.graphviz_image }}" onLoad="svg=this.contentDocument; graph=svg.getElementById('graph1'); installSVGonClickListeners(); ResetState(); Iterate();"></object>

	<script>
		function AutoLoad() {
			if ( document.getElementById('network').contentDocument.URL == 'about:blank' )
				window.location.href='../Import/BooleanNet';
			}
		window.setTimeout('AutoLoad();', 1000);
	</script>
</div>

<div id=biographertab>
	<link rel="stylesheet" type="text/css" href="{{ = URL(r=request, c='static', f='bui') }}/css/visualization-html.css" />
	<link rel="stylesheet" type="text/css" href="{{ = URL(r=request, c='static', f='bui') }}/css/jquery-ui-1.8.13.css" />

	<script type="text/javascript" src="{{ = URL(r=request, c='static', f='bui') }}/js/jquery-1.6.min.js"></script>
	<script type="text/javascript" src="{{ = URL(r=request, c='static', f='bui') }}/js/jquery.simulate.js"></script>
	<script type="text/javascript" src="{{ = URL(r=request, c='static', f='bui') }}/js/jquery-ui-1.8.12.custom.min.js"></script>
	<script type="text/javascript" src="{{ = URL(r=request, c='static', f='bui') }}/js/biographer-ui.js"></script>

	<div class=network id=canvas>
	</div>

	<script>
		network = {{ = XML(session.bioGraph.exportJSON()) }};

		bui.ready(function() {
		    graph = new bui.Graph( document.getElementById('canvas') );
		    bui.importFromJSON(graph, network);
		});
	</script>
</div>

Click the nodes to change their state.
Ctrl+Click to fix or release a node.
State-of-the-art browser required (Chrome or Firefox; not Internet Explorer).
SVG and JavaScript support required.

